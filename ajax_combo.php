<?php
// This script and data application were generated by AppGini 5.84
// Download AppGini for free from https://bigprof.com/appgini/download/

/*
	ajax-callable script that returns code for either a combo drop-down or an auto-complete
	drop-down, based on number of items.

	REQUEST parameters:
	===============
	t: table name
	f: lookup field name
	id: selected id
	p: page number (default = 1)
	s: search term
	o: 0 (default) for text-only or 1 for full options list
	text: selected text
	filterer_[filterer]: name of filterer field to be used to filter the drop-down contents
				must be one of the filteres defined for the concerned field
*/

	$start_ts = microtime(true);

	// how many results to return per call, in case of json output
	$results_per_page = 50;

	$curr_dir = dirname(__FILE__);
	include("$curr_dir/defaultLang.php");
	include("$curr_dir/language.php");
	include("$curr_dir/lib.php");

	handle_maintenance();

	// drop-downs config
	$lookups = array(
		'Customers' => array(
			'Type' => array(
				'parent_table' => 'CustomerClass',
				'parent_pk_field' => 'id',
				'parent_caption' => '`CustomerClass`.`Type`',
				'parent_from' => '`CustomerClass` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
			'City' => array(
				'parent_table' => 'City',
				'parent_pk_field' => 'id',
				'parent_caption' => '`City`.`City`',
				'parent_from' => '`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`City`.`Province` ',
				'filterers' => array('Province' => 'Province'),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
			'Province' => array(
				'parent_table' => 'Province',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Province`.`Province`',
				'parent_from' => '`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Province`.`Country` ',
				'filterers' => array('Country' => 'Country'),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
			'Country' => array(
				'parent_table' => 'Country',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Country`.`Country`',
				'parent_from' => '`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Retention' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Phone' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Phone`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Email' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Email`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Zone' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`Province1`.`Province`), CONCAT_WS(\'\',   `Province1`.`Province`), \'\')',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Assigned' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Alert' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'CustomerClass' => array(
		),
		'Staff' => array(
			'City' => array(
				'parent_table' => 'City',
				'parent_pk_field' => 'id',
				'parent_caption' => '`City`.`City`',
				'parent_from' => '`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`City`.`Province` ',
				'filterers' => array('Province' => 'Province'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Province' => array(
				'parent_table' => 'Province',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Province`.`Province`',
				'parent_from' => '`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Province`.`Country` ',
				'filterers' => array('Country' => 'Country'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Country' => array(
				'parent_table' => 'Country',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Country`.`Country`',
				'parent_from' => '`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Department' => array(
				'parent_table' => 'Department',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Department`.`Department`',
				'parent_from' => '`Department` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Position' => array(
				'parent_table' => 'Position',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Position`.`Position`',
				'parent_from' => '`Position` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Position`.`Department` ',
				'filterers' => array('Department' => 'Department'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Supervisor' => array(
				'parent_table' => 'Supervisor',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Supervisor`.`Supervisor`',
				'parent_from' => '`Supervisor` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Supervisor`.`Department` ',
				'filterers' => array('Department' => 'Department'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Manager' => array(
				'parent_table' => 'Manager',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Manager`.`Manager`',
				'parent_from' => '`Manager` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Manager`.`Department` ',
				'filterers' => array('Department' => 'Department'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Director' => array(
				'parent_table' => 'CEO',
				'parent_pk_field' => 'id',
				'parent_caption' => '`CEO`.`Chief`',
				'parent_from' => '`CEO` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`CEO`.`Department` ',
				'filterers' => array('Department' => 'Department'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Country' => array(
		),
		'Province' => array(
			'Country' => array(
				'parent_table' => 'Country',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Country`.`Country`',
				'parent_from' => '`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'City' => array(
			'Province' => array(
				'parent_table' => 'Province',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Province`.`Province`',
				'parent_from' => '`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Province`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Warehouse' => array(
		),
		'Tracking' => array(
			'WhID' => array(
				'parent_table' => 'Warehouse',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Warehouse`.`id`',
				'parent_from' => '`Warehouse` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Date' => array(
				'parent_table' => 'Warehouse',
				'parent_pk_field' => 'id',
				'parent_caption' => 'if(`Warehouse`.`Date`,date_format(`Warehouse`.`Date`,\'%m/%d/%Y\'),\'\')',
				'parent_from' => '`Warehouse` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Warehouse' => array(
				'parent_table' => 'Warehouse',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Warehouse`.`Warehouse`',
				'parent_from' => '`Warehouse` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
			'Employee' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => false
			),
			'Freight' => array(
				'parent_table' => 'Warehouse',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Warehouse`.`Freight`',
				'parent_from' => '`Warehouse` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Zone' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`Province1`.`Province`), CONCAT_WS(\'\',   `Province1`.`Province`), \'\')',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Status' => array(
			'TrackID' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`id`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Invoice' => array(
				'parent_table' => 'Invoice',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Invoice`.`id`',
				'parent_from' => '`Invoice` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Invoice`.`Customer` LEFT JOIN `Invoice` as Invoice1 ON `Invoice1`.`id`=`Invoice`.`related` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers1`.`City` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers1`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Tracking' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Tracking`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Dimensions' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Dimensions`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'RWeight' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Weight`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'VWeight' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Volume`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Total' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Total`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Invoice' => array(
			'Title' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Title`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => true
			),
			'Phone' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Phone`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Email' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Email`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Address' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Address`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'City' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`City1`.`City`), CONCAT_WS(\'\',   `City1`.`City`), \'\')',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Country' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`Country1`.`Country`), CONCAT_WS(\'\',   `Country1`.`Country`), \'\')',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'related' => array(
				'parent_table' => 'Invoice',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`Invoice`.`id`) || CHAR_LENGTH(`Invoice`.`number`), CONCAT_WS(\'\', `Invoice`.`id`, \' - \', `Invoice`.`number`), \'\')',
				'parent_from' => '`Invoice` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Invoice`.`Customer` LEFT JOIN `Invoice` as Invoice1 ON `Invoice1`.`id`=`Invoice`.`related` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers1`.`City` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers1`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'InvoiceDetails' => array(
			'invoice' => array(
				'parent_table' => 'Invoice',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Invoice`.`id`',
				'parent_from' => '`Invoice` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Invoice`.`Customer` LEFT JOIN `Invoice` as Invoice1 ON `Invoice1`.`id`=`Invoice`.`related` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers1`.`City` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers1`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'product' => array(
				'parent_table' => 'Products',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`Products`.`code`) || CHAR_LENGTH(`Products`.`item`), CONCAT_WS(\'\', `Products`.`code`, \' - \', `Products`.`item`), \'\')',
				'parent_from' => '`Products` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'itemSale' => array(
				'parent_table' => 'Products',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Products`.`itemSale`',
				'parent_from' => '`Products` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Products' => array(
		),
		'WHJournal' => array(
		),
		'CRM' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Assigned' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Payroll' => array(
			'employee' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Brand' => array(
		),
		'Model' => array(
			'Brand' => array(
				'parent_table' => 'Brand',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Brand`.`Brand`',
				'parent_from' => '`Brand` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'System' => array(
		),
		'Part' => array(
			'System' => array(
				'parent_table' => 'System',
				'parent_pk_field' => 'id',
				'parent_caption' => '`System`.`System`',
				'parent_from' => '`System` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'DatabaseAUTO' => array(
			'Brand' => array(
				'parent_table' => 'Brand',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Brand`.`Brand`',
				'parent_from' => '`Brand` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Model' => array(
				'parent_table' => 'Model',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Model`.`Model`',
				'parent_from' => '`Model` LEFT JOIN `Brand` as Brand1 ON `Brand1`.`id`=`Model`.`Brand` ',
				'filterers' => array('Brand' => 'Brand'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'System' => array(
				'parent_table' => 'System',
				'parent_pk_field' => 'id',
				'parent_caption' => '`System`.`System`',
				'parent_from' => '`System` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Part' => array(
				'parent_table' => 'Part',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Part`.`Part`',
				'parent_from' => '`Part` LEFT JOIN `System` as System1 ON `System1`.`id`=`Part`.`System` ',
				'filterers' => array('System' => 'System'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'GeneralDB' => array(
		),
		'CustomerAuto' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Brand' => array(
				'parent_table' => 'Brand',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Brand`.`Brand`',
				'parent_from' => '`Brand` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Model' => array(
				'parent_table' => 'Model',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Model`.`Model`',
				'parent_from' => '`Model` LEFT JOIN `Brand` as Brand1 ON `Brand1`.`id`=`Model`.`Brand` ',
				'filterers' => array('Brand' => 'Brand'),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Compras' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Employee' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Description' => array(
				'parent_table' => 'Products',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Products`.`item`',
				'parent_from' => '`Products` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'TrackingCenter' => array(
			'Name' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => true
			),
			'Zone' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`Province1`.`Province`), CONCAT_WS(\'\',   `Province1`.`Province`), \'\')',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Tracking' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Tracking`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => true
			),
		),
		'Claim' => array(
			'Warehouse' => array(
				'parent_table' => 'Warehouse',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Warehouse`.`Warehouse`',
				'parent_from' => '`Warehouse` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Tracking' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Tracking`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Activities' => array(
			'Assigned' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Return' => array(
			'Warehouse' => array(
				'parent_table' => 'Warehouse',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Warehouse`.`Warehouse`',
				'parent_from' => '`Warehouse` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Tracking' => array(
				'parent_table' => 'Tracking',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Tracking`.`Tracking`',
				'parent_from' => '`Tracking` LEFT JOIN `Warehouse` as Warehouse1 ON `Warehouse1`.`id`=`Tracking`.`Warehouse` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Tracking`.`Customer` LEFT JOIN `Staff` as Staff1 ON `Staff1`.`id`=`Tracking`.`Employee` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers1`.`Province` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Department' => array(
		),
		'Position' => array(
			'Department' => array(
				'parent_table' => 'Department',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Department`.`Department`',
				'parent_from' => '`Department` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'CEO' => array(
			'Department' => array(
				'parent_table' => 'Department',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Department`.`Department`',
				'parent_from' => '`Department` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Manager' => array(
			'Department' => array(
				'parent_table' => 'Department',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Department`.`Department`',
				'parent_from' => '`Department` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Supervisor' => array(
			'Department' => array(
				'parent_table' => 'Department',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Department`.`Department`',
				'parent_from' => '`Department` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Losses' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Subscriptions' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'Accounting' => array(
			'invoice' => array(
				'parent_table' => 'Invoice',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`Invoice`.`number`) || CHAR_LENGTH(`Invoice`.`Customer`), CONCAT_WS(\'\', `Invoice`.`number`, \' - \', IF(    CHAR_LENGTH(`Customers1`.`Customer`), CONCAT_WS(\'\',   `Customers1`.`Customer`), \'\')), \'\')',
				'parent_from' => '`Invoice` LEFT JOIN `Customers` as Customers1 ON `Customers1`.`id`=`Invoice`.`Customer` LEFT JOIN `Invoice` as Invoice1 ON `Invoice1`.`id`=`Invoice`.`related` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers1`.`City` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers1`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'account_plan' => array(
				'parent_table' => 'AccountPlan',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`AccountPlan`.`description`) || CHAR_LENGTH(`AccountPlan`.`code`), CONCAT_WS(\'\', `AccountPlan`.`description`, \' - \', `AccountPlan`.`code`), \'\')',
				'parent_from' => '`AccountPlan` LEFT JOIN `MasterAccount` as MasterAccount1 ON `MasterAccount1`.`id`=`AccountPlan`.`master_account` LEFT JOIN `Account` as Account1 ON `Account1`.`id`=`AccountPlan`.`account` LEFT JOIN `SubAccount` as SubAccount1 ON `SubAccount1`.`id`=`AccountPlan`.`sub_account` LEFT JOIN `Type` as Type1 ON `Type1`.`id`=`AccountPlan`.`type` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'master_account' => array(
				'parent_table' => 'AccountPlan',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`MasterAccount1`.`masterAccount`) || CHAR_LENGTH(`MasterAccount1`.`code`), CONCAT_WS(\'\',   `MasterAccount1`.`masterAccount`, \' - \', `MasterAccount1`.`code`), \'\')',
				'parent_from' => '`AccountPlan` LEFT JOIN `MasterAccount` as MasterAccount1 ON `MasterAccount1`.`id`=`AccountPlan`.`master_account` LEFT JOIN `Account` as Account1 ON `Account1`.`id`=`AccountPlan`.`account` LEFT JOIN `SubAccount` as SubAccount1 ON `SubAccount1`.`id`=`AccountPlan`.`sub_account` LEFT JOIN `Type` as Type1 ON `Type1`.`id`=`AccountPlan`.`type` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'account' => array(
				'parent_table' => 'AccountPlan',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`Account1`.`Account`) || CHAR_LENGTH(`Account1`.`code`), CONCAT_WS(\'\',   `Account1`.`Account`, \' - \', `Account1`.`code`), \'\')',
				'parent_from' => '`AccountPlan` LEFT JOIN `MasterAccount` as MasterAccount1 ON `MasterAccount1`.`id`=`AccountPlan`.`master_account` LEFT JOIN `Account` as Account1 ON `Account1`.`id`=`AccountPlan`.`account` LEFT JOIN `SubAccount` as SubAccount1 ON `SubAccount1`.`id`=`AccountPlan`.`sub_account` LEFT JOIN `Type` as Type1 ON `Type1`.`id`=`AccountPlan`.`type` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'sub_account' => array(
				'parent_table' => 'AccountPlan',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`SubAccount1`.`subAccount`) || CHAR_LENGTH(`SubAccount1`.`code`), CONCAT_WS(\'\',   `SubAccount1`.`subAccount`, \' - \', `SubAccount1`.`code`), \'\')',
				'parent_from' => '`AccountPlan` LEFT JOIN `MasterAccount` as MasterAccount1 ON `MasterAccount1`.`id`=`AccountPlan`.`master_account` LEFT JOIN `Account` as Account1 ON `Account1`.`id`=`AccountPlan`.`account` LEFT JOIN `SubAccount` as SubAccount1 ON `SubAccount1`.`id`=`AccountPlan`.`sub_account` LEFT JOIN `Type` as Type1 ON `Type1`.`id`=`AccountPlan`.`type` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'type' => array(
				'parent_table' => 'AccountPlan',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(    CHAR_LENGTH(`Type1`.`type`), CONCAT_WS(\'\',   `Type1`.`type`), \'\')',
				'parent_from' => '`AccountPlan` LEFT JOIN `MasterAccount` as MasterAccount1 ON `MasterAccount1`.`id`=`AccountPlan`.`master_account` LEFT JOIN `Account` as Account1 ON `Account1`.`id`=`AccountPlan`.`account` LEFT JOIN `SubAccount` as SubAccount1 ON `SubAccount1`.`id`=`AccountPlan`.`sub_account` LEFT JOIN `Type` as Type1 ON `Type1`.`id`=`AccountPlan`.`type` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
		'AccountPlan' => array(
			'master_account' => array(
				'parent_table' => 'MasterAccount',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`MasterAccount`.`masterAccount`) || CHAR_LENGTH(`MasterAccount`.`code`), CONCAT_WS(\'\', `MasterAccount`.`masterAccount`, \' - \', `MasterAccount`.`code`), \'\')',
				'parent_from' => '`MasterAccount` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => true
			),
			'account' => array(
				'parent_table' => 'Account',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`Account`.`Account`) || CHAR_LENGTH(`Account`.`code`), CONCAT_WS(\'\', `Account`.`Account`, \' - \', `Account`.`code`), \'\')',
				'parent_from' => '`Account` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => true
			),
			'sub_account' => array(
				'parent_table' => 'SubAccount',
				'parent_pk_field' => 'id',
				'parent_caption' => 'IF(CHAR_LENGTH(`SubAccount`.`subAccount`) || CHAR_LENGTH(`SubAccount`.`code`), CONCAT_WS(\'\', `SubAccount`.`subAccount`, \' - \', `SubAccount`.`code`), \'\')',
				'parent_from' => '`SubAccount` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => true
			),
			'type' => array(
				'parent_table' => 'Type',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Type`.`type`',
				'parent_from' => '`Type` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => true
			),
		),
		'MasterAccount' => array(
		),
		'Account' => array(
		),
		'SubAccount' => array(
		),
		'Type' => array(
		),
		'CCJournal' => array(
			'Card' => array(
				'parent_table' => 'CC',
				'parent_pk_field' => 'id',
				'parent_caption' => '`CC`.`Card`',
				'parent_from' => '`CC` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Logged' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => true,
				'list_type' => 0,
				'not_null' => true
			),
		),
		'CC' => array(
		),
		'Receivable' => array(
			'Customer' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Customer`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Phone' => array(
				'parent_table' => 'Customers',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Customers`.`Phone`',
				'parent_from' => '`Customers` LEFT JOIN `CustomerClass` as CustomerClass1 ON `CustomerClass1`.`id`=`Customers`.`Type` LEFT JOIN `City` as City1 ON `City1`.`id`=`Customers`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Customers`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Customers`.`Country` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
			'Assigned' => array(
				'parent_table' => 'Staff',
				'parent_pk_field' => 'id',
				'parent_caption' => '`Staff`.`Employee`',
				'parent_from' => '`Staff` LEFT JOIN `City` as City1 ON `City1`.`id`=`Staff`.`City` LEFT JOIN `Province` as Province1 ON `Province1`.`id`=`Staff`.`Province` LEFT JOIN `Country` as Country1 ON `Country1`.`id`=`Staff`.`Country` LEFT JOIN `Department` as Department1 ON `Department1`.`id`=`Staff`.`Department` LEFT JOIN `Position` as Position1 ON `Position1`.`id`=`Staff`.`Position` LEFT JOIN `Supervisor` as Supervisor1 ON `Supervisor1`.`id`=`Staff`.`Supervisor` LEFT JOIN `Manager` as Manager1 ON `Manager1`.`id`=`Staff`.`Manager` LEFT JOIN `CEO` as CEO1 ON `CEO1`.`id`=`Staff`.`Director` ',
				'filterers' => array(),
				'custom_query' => '',
				'inherit_permissions' => false,
				'list_type' => 0,
				'not_null' => false
			),
		),
	);

	// XSS prevention
	$xss = new CI_Input();
	$xss->charset = datalist_db_encoding;

	// receive and verify user input
	$table_name = $_REQUEST['t'];
	$field_name = $_REQUEST['f'];
	$search_id = makeSafe(from_utf8($_REQUEST['id']));
	$selected_text = from_utf8($_REQUEST['text']);
	$returnOptions = ($_REQUEST['o'] == 1 ? true : false);
	$page = intval($_REQUEST['p']);
	if($page < 1)  $page = 1;
	$skip = $results_per_page * ($page - 1);
	$search_term = makeSafe(from_utf8($_REQUEST['s']));

	if(!isset($lookups[$table_name][$field_name])) die('{ "error": "Invalid table or field." }');

	// can user access the requested table?
	$perm = getTablePermissions($table_name);
	if(!$perm[0] && !$search_id) die('{ "error": "' . addslashes($Translation['tableAccessDenied']) . '" }');

	$field = $lookups[$table_name][$field_name];

	$wheres = array();

	// search term provided?
	if($search_term) {
		$wheres[] = "{$field['parent_caption']} like '%{$search_term}%'";
	}

	// any filterers specified?
	if(is_array($field['filterers'])) {
		foreach($field['filterers'] as $filterer => $filterer_parent) {
			$get = (isset($_REQUEST["filterer_{$filterer}"]) ? $_REQUEST["filterer_{$filterer}"] : false);
			if($get) {
				$wheres[] = "`{$field['parent_table']}`.`$filterer_parent`='" . makeSafe($get) . "'";
			}
		}
	}

	// inherit permissions?
	if($field['inherit_permissions']) {
		$inherit = permissions_sql($field['parent_table']);
		if($inherit === false && !$search_id) die($Translation['tableAccessDenied']);

		if($inherit['where']) $wheres[] = $inherit['where'];
		if($inherit['from']) $field['parent_from'] .= ", {$inherit['from']}";
	}

	// single value?
	if($field['list_type'] != 2 && $search_id) {
		$wheres[] = "`{$field['parent_table']}`.`{$field['parent_pk_field']}`='{$search_id}'";
	}

	if(count($wheres)) {
		$where = 'WHERE ' . implode(' AND ', $wheres);
	}

	// define the combo and return the code
	$combo = new DataCombo;
	if($field['custom_query']) {
		$qm = array(); $custom_where = ''; $custom_order_by = '2';
		$combo->Query = $field['custom_query'];

		if(preg_match('/ order by (.*)$/i', $combo->Query, $qm)) {
			$custom_order_by = $qm[1];
			$combo->Query = preg_replace('/ order by .*$/i', '', $combo->Query);
		}

		if(preg_match('/ where (.*)$/i', $combo->Query, $qm)) {
			$custom_where = $qm[1];
			$combo->Query = preg_replace('/ where .*$/i', '', $combo->Query);
		}

		if($where && $custom_where) {
			$combo->Query .=  " {$where} AND ({$custom_where}) ORDER BY {$custom_order_by}";
		}elseif($custom_where) {
			$combo->Query .=  " WHERE {$custom_where} ORDER BY {$custom_order_by}";
		}else{
			$combo->Query .=  " {$where} ORDER BY {$custom_order_by}";
		}

		$query_match = array();
		preg_match('/select (.*) from (.*)$/i', $combo->Query, $query_match);

		if(isset($query_match[2])) {
			$count_query = "SELECT count(1) FROM {$query_match[2]}";
		}else{
			$count_query = '';
		}
	}else{
		$combo->Query = "SELECT " . ($field['inherit_permissions'] ? 'DISTINCT ' : '') . "`{$field['parent_table']}`.`{$field['parent_pk_field']}`, {$field['parent_caption']} FROM {$field['parent_from']} {$where} ORDER BY 2";
		$count_query = "SELECT count(1) FROM {$field['parent_from']} {$where}";
	}
	$combo->table = $table_name;
	$combo->parent_table = $field['parent_table'];
	$combo->SelectName = $field_name;
	$combo->ListType = $field['list_type'];
	if($search_id) {
		$combo->SelectedData = $search_id;
	}elseif($selected_text) {
		$combo->SelectedData = getValueGivenCaption($combo->Query, $selected_text);
	}

	if($field['list_type'] == 2) {
		$combo->Render();
		$combo->HTML = str_replace('<select ', '<select onchange="' . $field_name . '_changed();" ', $combo->HTML);

		// return response
		if($returnOptions) {
			?><span id="<?php echo $field_name; ?>-combo-list"><?php echo $combo->HTML; ?></span><?php
		}else{
			?>
				<span id="<?php echo $field_name; ?>-match-text"><?php echo $combo->MatchText; ?></span>
				<input type="hidden" id="<?php echo $field_name; ?>" value="<?php echo html_attr($combo->SelectedData); ?>" />
			<?php
		}
	}else{
		/* return json */
		header('Content-type: application/json');

		if(!preg_match('/ limit .+/i', $combo->Query)) {
			if(!$search_id) $combo->Query .= " LIMIT {$skip}, {$results_per_page}";
			if($search_id) $combo->Query .= " LIMIT 1";
		}

		$prepared_data = array();

		// specific caption provided and list_type is not radio?
		if(!$search_id && $selected_text) {
			$search_id = getValueGivenCaption($combo->Query, $selected_text);
			if($search_id) $prepared_data[] = array('id' => to_utf8($search_id), 'text' => to_utf8($xss->xss_clean($selected_text)));
		}else{
			/*
			 * in case we have a search term, show matches starting with it first,
			 * followed by those containing it.
			 * build a UNION query for that purpose
			 */
			if($search_term) {
				$query2 = $combo->Query;
				$query1 = str_replace(" like '%{$search_term}%'", " like '{$search_term}%'", $query2);
				$combo->Query = "({$query1}) UNION ({$query2})";
			}

			$eo = array('silentErrors' => true);

			$res = sql($combo->Query, $eo);
			while($row = db_fetch_row($res)) {
				if(empty($prepared_data) && $page == 1 && !$search_id && !$field['not_null']) {
					$prepared_data[] = array('id' => empty_lookup_value, 'text' => to_utf8("<{$Translation['none']}>"));
				}

				$prepared_data[] = array('id' => to_utf8($row[0]), 'text' => to_utf8($xss->xss_clean($row[1])));
			}
		}

		if(empty($prepared_data)) { $prepared_data[] = array('id' => '', 'text' => to_utf8($Translation['No matches found!'])); }

		echo json_encode(array(
			'results' => $prepared_data,
			'more' => (@db_num_rows($res) >= $results_per_page),
			'elapsed' => round(microtime(true) - $start_ts, 3)
		));
	}

